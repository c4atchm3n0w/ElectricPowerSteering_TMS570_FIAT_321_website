---
title: MtrCntrl_Integration_Manual
linkTitle: MtrCntrl_Integration_Manual
weight: 6
---

<p><a href="#dependencies">1 Dependencies <span>2</span></a></p>
<p><a href="#swcs">1.1 SWCs <span>2</span></a></p>
<p><a href="#configuration-files-to-be-provided-by-integration-project">1.2 Configuration Files to be provided by Integration Project <span>2</span></a></p>
<p><a href="#functions-to-be-provided-to-integration-project">1.3 Functions to be provided by Integration Project <span>2</span></a></p>
<p><a href="#configuration">2 Configuration <span>3</span></a></p>
<p><a href="#build-time-config">2.1 Build Time Config <span>3</span></a></p>
<p><a href="#generator-config">2.2 Generator Config <span>3</span></a></p>
<p><a href="#integration">3 Integration <span>4</span></a></p>
<p><a href="#global-data">3.1 Global Data <span>4</span></a></p>
<p><a href="#component-conflicts">3.2 Component Conflicts <span>4</span></a></p>
<p><a href="#include-path">3.3 Include Path <span>4</span></a></p>
<p><a href="#_Toc348692770">3.4 ADC2 Changes <span>4</span></a></p>
<p><a href="#configurator-changes">3.5 Configurator Changes <span>4</span></a></p>
<p><a href="#_Toc348692772">3.5.1 DIO <span>4</span></a></p>
<p><a href="#_Toc348692773">3.5.2 Port <span>5</span></a></p>
<p><a href="#runnable-scheduling">4 Runnable Scheduling <span>6</span></a></p>
<p><a href="#memory-mapping">5 Memory Mapping <span>7</span></a></p>
<p><a href="#mapping">5.1 Mapping <span>7</span></a></p>
<p><a href="#usage">5.2 Usage <span>7</span></a></p>
<p><a href="#revision-control-log">6 Revision Control Log <span>8</span></a></p>
<h1 id="dependencies">Dependencies</h1>
<h2 id="swcs">SWCs</h2>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="header">
<th>Module</th>
<th>Required Feature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="configuration-files-to-be-provided-by-integration-project">Configuration Files to be provided by Integration Project</h2>
<p>MtrCtrl_Cfg.h</p>
<p><img src="ElectricPowerSteering_TMS570_FIAT_321_website/static/media/image1.emf" /></p>
<h2 id="functions-to-be-provided-to-integration-project">Functions to be provided to Integration Project</h2>
<p>PICurrCntrl_Per1()</p>
<p>TrqCogCancRefPer1()</p>
<h1 id="configuration">Configuration</h1>
<h2 id="build-time-config">Build Time Config</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 36%" />
<col style="width: 53%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>Modules</th>
<th>Notes</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>PICurrentCntrl</p>
<p>TrqCanc</p></td>
<td>Optimization level greater than 3</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="generator-config">Generator Config</h2>
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 47%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="header">
<th>Constant</th>
<th>Notes</th>
<th>SWC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="integration">Integration</h1>
<h2 id="global-data">Global Data</h2>
<p>The global symbols mapping done in MtrCtrl_Cfg.h.</p>
<h2 id="component-conflicts">Component Conflicts</h2>
<p>None</p>
<h2 id="include-path">Include Path</h2>
<p>The “include” directory of this SWC needs to be included in the integration project include search path.</p>
<p>.</p>
<h2 id="configurator-changes">Configurator Changes</h2>
<p>None</p>
<h1 id="runnable-scheduling">Runnable Scheduling</h1>
<p>This section specifies the required runnable scheduling.</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 55%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th>Runnable</th>
<th>Scheduling Requirements</th>
<th>Trigger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TrqCogCancRefPer1()</td>
<td>Must be placed in the motor control ISR, after MtrPos</td>
<td>Cyclic (ISR)</td>
</tr>
<tr class="even">
<td>PICurrCntrl_Per1()</td>
<td>Must be placed in the motor control ISR after TrqCogCancRefPer1()</td>
<td>Cyclic (ISR)</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 53%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="header">
<th>Runnable</th>
<th>Scheduling Requirements</th>
<th>Trigger</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CurrParamComp_Init()</td>
<td></td>
<td>RTE (init)</td>
</tr>
<tr class="even">
<td>PICurrCntrl_Init()</td>
<td></td>
<td>RTE (init)</td>
</tr>
<tr class="odd">
<td>TrqCanc_Init</td>
<td>Must be placed after CurrParamComp_Init</td>
<td>RTE (init)</td>
</tr>
<tr class="even">
<td>QuadDet_Per1</td>
<td>Must run after TrqReasonable Diagnostics</td>
<td>RTE (2ms)</td>
</tr>
<tr class="odd">
<td>CurrCmd_Per1</td>
<td>Must run after QuadDet</td>
<td>RTE (2ms)</td>
</tr>
<tr class="even">
<td>TrqCanc_Per1</td>
<td>Must run after CurrCmd_Per1</td>
<td>RTE (2ms)</td>
</tr>
<tr class="odd">
<td>PICurrCntrl_Per2()</td>
<td>Must be placed after TrqCanc_Per1</td>
<td>RTE (2ms)</td>
</tr>
<tr class="even">
<td>CurrParamComp_Per1()</td>
<td>Must be placed after PICurrCntrl_Per2</td>
<td>RTE (2ms)</td>
</tr>
<tr class="odd">
<td>PeakCurrEst_Per1()</td>
<td>Must be placed after PICurrCntrl_Per2</td>
<td>RTE (2ms)</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>*Note: In motor control ISR include Ap_MtrCtrl.h instead of CDD_Func.h</p>
<p>Proper Initialization of input signals should occur before running each function for the first time. <strong>(CurrParamComp_Init).</strong></p>
<h1 id="memory-mapping">Memory Mapping</h1>
<h2 id="mapping">Mapping</h2>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 26%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="header">
<th>Memory Section</th>
<th>Contents</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RTE Memory mapping</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>* Each …START_SEC… constant is terminated by a …STOP_SEC… constant as specified in the AUTOSAR Memory Mapping requirements.</p>
<h2 id="usage">Usage</h2>
<table>
<colgroup>
<col style="width: 55%" />
<col style="width: 23%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>RAM</th>
<th>ROM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Full driver</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 class="unnumbered" id="table-1-arm-cortex-r4-memory-usage">Table 1: ARM Cortex R4 Memory Usage</h2>
<h2 id="rte-nvm-blocks"> RTE NvM Blocks</h2>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>Block Name Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rte_Pim_CogTrqCal 512</td>
</tr>
<tr class="even">
<td>Rte_Pim_CogTrqRplComp 9</td>
</tr>
</tbody>
</table>
<p>Note : Size of the NVM block is changed.</p>
<h2 class="unnumbered" id="section"></h2>
<h1 id="revision-control-log">Revision Control Log</h1>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 71%" />
<col style="width: 12%" />
<col style="width: 8%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Rev #</strong></td>
<td><strong>Change Description</strong></td>
<td><strong>Date</strong></td>
<td><strong>Author</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>Initial version</td>
<td>25-Mar-13</td>
<td>Selva</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Updated TrqCanc_Init in RTE Runnables and size of the NVM block CogTrqCal is changed from 512 to 521</td>
<td>21-Oct-13</td>
<td>Selva</td>
</tr>
<tr class="even">
<td>3</td>
<td>Added new NVM block “Rte_Pim_CogTrqRplComp”</td>
<td>23-Oct-13</td>
<td>Selva</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Added new scheduling requirement for PICurrcntrl Initialisation</td>
<td>5-Mar-15</td>
<td>Selva</td>
</tr>
</tbody>
</table>
